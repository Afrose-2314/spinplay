<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Memory Match</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%);
    margin: 0;
    padding: 20px;
    min-height: 100vh;
  }
  #instructionOverlay {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.75);
    color: white;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    font-size: 22px;
    padding: 20px;
    z-index: 1000;
  }
  #instructionOverlay button {
    margin-top: 20px;
    padding: 10px 30px;
    font-size: 18px;
    border-radius: 6px;
    border: none;
    background-color: #0984e3;
    color: white;
    cursor: pointer;
  }
  #instructionOverlay button:hover {
    background-color: #0652dd;
  }
  #board {
    display: grid;
    grid-template-columns: repeat(4, 100px);
    gap: 10px;
    justify-content: center;
    margin: 30px auto;
    user-select: none;
  }
  .card {
    width: 100px;
    height: 100px;
    background-color: #ccc;
    font-size: 3em;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background 0.3s;
    border-radius: 10px;
  }
  .flipped {
    background-color: #fff;
  }
  .matched {
    background-color: #81c784;
    cursor: default;
    pointer-events: none;
  }
  .result {
    font-size: 1.5em;
    margin-top: 20px;
  }
  .winner {
    animation: pulse 1s infinite;
    color: #2ecc71;
  }
  .loser {
    animation: shake 0.5s infinite;
    color: #e74c3c;
  }
  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
  }
  @keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-5px); }
    75% { transform: translateX(5px); }
  }
  #score, #timer {
    font-weight: bold;
    font-size: 20px;
    color: white;
  }
</style>
</head>
<body>

<div id="instructionOverlay">
  <p>Welcome to Memory Match!<br/>
  Match all pairs before time runs out.<br/>
  You have 60 seconds.<br/>
  Good luck!</p>
  <button id="startBtn">OK</button>
</div>

<h2 style="color: white;">üß† Memory Match</h2>
<p style="color: white;">Match all pairs before time runs out!</p>
<div id="board"></div>
<p id="score">Matches: 0</p>
<p id="timer">‚è≥ Time: 60s</p>
<div class="result" id="resultText"></div>

<script>
  const overlay = document.getElementById('instructionOverlay');
  const startBtn = document.getElementById('startBtn');
  const board = document.getElementById('board');
  const scoreDisplay = document.getElementById('score');
  const timerDisplay = document.getElementById('timer');
  const resultText = document.getElementById('resultText');

  const emojis = ['ü§ç','ü§é','üíú','‚ù§Ô∏è','ü©∑','üß°','üíõ','üíö','üíô','ü©µ'];
  let cards = emojis.concat(emojis);

  let firstCard = null;
  let secondCard = null;
  let matchedCount = 0;
  let timeLeft = 60;
  let timerInterval = null;
  let busy = false;
  let gameStarted = false;

  // Shuffle cards
  function shuffle(array) {
    for(let i = array.length -1; i > 0; i--) {
      let j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  function createBoard() {
    board.innerHTML = '';
    cards.forEach((emoji, index) => {
      const card = document.createElement('div');
      card.classList.add('card');
      card.dataset.emoji = emoji;
      card.dataset.index = index;
      card.innerText = '';
      card.addEventListener('click', () => flipCard(card));
      board.appendChild(card);
    });
  }

  function flipCard(card) {
    if (busy || card.classList.contains('flipped') || card.classList.contains('matched')) return;
    card.classList.add('flipped');
    card.innerText = card.dataset.emoji;

    if (!firstCard) {
      firstCard = card;
    } else if (!secondCard && card !== firstCard) {
      secondCard = card;
      busy = true;

      if (firstCard.dataset.emoji === secondCard.dataset.emoji) {
        firstCard.classList.add('matched');
        secondCard.classList.add('matched');
        matchedCount++;
        scoreDisplay.innerText = `Matches: ${matchedCount}`;
        firstCard = null;
        secondCard = null;
        busy = false;

        if (matchedCount === emojis.length) {
          endGame(true);
        }
      } else {
        setTimeout(() => {
          firstCard.classList.remove('flipped');
          secondCard.classList.remove('flipped');
          firstCard.innerText = '';
          secondCard.innerText = '';
          firstCard = null;
          secondCard = null;
          busy = false;
        }, 800);
      }
    }
  }

  function startTimer() {
    timerDisplay.innerText = `‚è≥ Time: ${timeLeft}s`;
    timerInterval = setInterval(() => {
      timeLeft--;
      timerDisplay.innerText = `‚è≥ Time: ${timeLeft}s`;
      if (timeLeft < 0) {
        clearInterval(timerInterval);
        endGame(false);
      }
    }, 1000);
  }

  function endGame(won) {
    gameStarted = false;
    clearInterval(timerInterval);
    board.querySelectorAll('.card').forEach(card => card.removeEventListener('click', () => flipCard(card)));
    resultText.className = won ? "result winner" : "result loser";
    resultText.innerText = won ? "üéâ You Win!" : "‚è∞ Time's up!";
    // Disable further clicks
    board.querySelectorAll('.card').forEach(card => card.style.pointerEvents = 'none');
    setTimeout(() => {
      window.location.href = 'index.html';
    }, 10000);
  }

  startBtn.onclick = () => {
    // show instructions only once per session
    if(!sessionStorage.getItem('memoryInstructionsShown')) {
      sessionStorage.setItem('memoryInstructionsShown', 'true');
    }
    overlay.style.display = 'none';
    initGame();
  };

  // If instructions already seen, start immediately
  if(sessionStorage.getItem('memoryInstructionsShown')) {
    overlay.style.display = 'none';
    initGame();
  }

  function initGame() {
    gameStarted = true;
    timeLeft = 60;
    matchedCount = 0;
    scoreDisplay.innerText = `Matches: 0`;
    resultText.innerText = '';
    shuffle(cards);
    createBoard();
    startTimer();
  }
</script>

</body>
</html>
